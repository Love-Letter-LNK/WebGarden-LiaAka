generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// ============ USER & AUTH ============

model User {
  id           String   @id @default(cuid())
  email        String   @unique
  passwordHash String
  role         String   @default("user") // "admin" or "user"
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

// ============ MEMORIES ============

model Memory {
  id        String        @id @default(cuid())
  slug      String        @unique
  title     String
  date      DateTime
  category  String
  tags      String        // Comma-separated string for SQLite compatibility
  mood      String?
  quote     String?
  story     String?
  location  String?
  images    MemoryImage[]
  createdAt DateTime      @default(now())
  updatedAt DateTime      @updatedAt
}

model MemoryImage {
  id        String   @id @default(cuid())
  memoryId  String
  memory    Memory   @relation(fields: [memoryId], references: [id], onDelete: Cascade)
  url       String
  alt       String?
  sortOrder Int      @default(0)
  createdAt DateTime @default(now())
}

// ============ NEWS ============

model News {
  id        String   @id @default(cuid())
  title     String
  date      DateTime
  category  String   // celebration, date, announcement, update
  emoji     String   @default("ðŸ“°")
  content   String?
  published Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// ============ JOURNEY (Timeline Milestones) ============

model Journey {
  id          String   @id @default(cuid())
  title       String
  date        DateTime
  description String?
  icon        String   @default("ðŸ’•")
  sortOrder   Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// ============ PROFILES (Zekk & Lia) ============

model Profile {
  id           String   @id @default(cuid())
  slug         String   @unique // "zekk" or "lia"
  name         String
  nickname     String?
  bio          String?
  birthDate    String?
  hobbies      String?  // Comma-separated
  likes        String?  // Comma-separated
  loveLanguage String?
  funFacts     String?  // JSON array as string for SQLite
  avatar       String?
  color        String   @default("#ec4899") // Theme color (pink/blue)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

// ============ CONTACT MESSAGES ============

model ContactMessage {
  id         String   @id @default(cuid())
  recipient  String   // "zekk" or "lia"
  message    String
  senderName String?
  senderEmail String?
  isRead     Boolean  @default(false)
  createdAt  DateTime @default(now())
}

// ============ GALLERY ============

model Gallery {
  id        String   @id @default(cuid())
  url       String
  alt       String?
  category  String?
  year      String?  @default("2024") // Display year on catalog cards
  sortOrder Int      @default(0)
  createdAt DateTime @default(now())
}

// ============ TRAVEL LOG ============

model TravelLog {
  id          String        @id @default(cuid())
  name        String
  description String?
  story       String?       // Longer story/memory about the trip
  date        String?       // String to allow flexible formats like "May 2024" or ISO
  isVisited   Boolean       @default(false)
  lat         Float?
  lng         Float?
  images      TravelImage[]
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
}

model TravelImage {
  id          String    @id @default(cuid())
  url         String
  caption     String?
  sortOrder   Int       @default(0)
  travelLog   TravelLog @relation(fields: [travelLogId], references: [id], onDelete: Cascade)
  travelLogId String
  createdAt   DateTime  @default(now())
}

// ============ VISITORS ============

model Visitor {
  id         String   @id @default(cuid())
  ip         String?
  userAgent  String?
  country    String?
  city       String?
  page       String   @default("/")
  referer    String?
  deviceType String?  // desktop, mobile, tablet
  browser    String?
  os         String?
  isUnique   Boolean  @default(true) // First visit of the day from this IP
  createdAt  DateTime @default(now())
}

model SiteStats {
  id            String   @id @default("main")
  totalVisitors Int      @default(0)
  uniqueToday   Int      @default(0)
  lastResetDate DateTime @default(now())
  updatedAt     DateTime @updatedAt
}
